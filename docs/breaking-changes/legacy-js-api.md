---
title: Устаревший JS API
icon: lucide/newspaper
---

> Dart Sass изначально использовал API, основанный на API Node Sass, но в Dart Sass 1.45.0 заменил его на новый современный API. Устаревший JS API теперь устарел и будет удалён в Dart Sass 2.0.0.

## Перенос использования {#migration-usage}

### Точки входа {#entrypoints}

Устаревший JS API имел две точки входа для компиляции Sass: `render` и `renderSync`, которые принимали объект опций, включавший либо `file` (для компиляции файла), либо `data` (для компиляции строки). Современный API имеет четыре: `compile` и `compileAsync` для компиляции файла и `compileString` и `compileStringAsync` для компиляции строки. Эти функции принимают путь или исходную строку как первый аргумент, а затем объект со всеми остальными опциями как второй аргумент. В отличие от `render`, которая использовала callback, `compileAsync` и `compileStringAsync` возвращают промис.

См. [документацию по использованию](https://sass-lang.com/documentation/js-api/#md:usage) для получения дополнительной информации.

### Импортеры {#importers}

Импортеры в устаревшем API состояли из одной функции, которая принимала URL правила зависимости и URL содержащей таблицы стилей (а также `done` callback для асинхронных импортеров) и возвращала объект с путём `file` на диске или `contents` таблицы стилей для загрузки.

Современные API [`Importer`](https://sass-lang.com/documentation/js-api/interfaces/Importer/) содержат два метода: `canonicalize`, который принимает URL правила и возвращает каноническую форму этого URL; и `load`, который принимает канонический URL и возвращает объект с содержимым загруженной таблицы стилей. Такое разделение гарантирует, что один и тот же модуль загружается только один раз и что относительные URL работают последовательно. Асинхронные импортеры возвращают промисы для обоих этих методов.

Также существует специальный [`FileImporter`](https://sass-lang.com/documentation/js-api/interfaces/FileImporter/), который перенаправляет все загрузки на существующие файлы на диске, который следует использовать при переносе с устаревших импортеров, возвращавших `file` вместо `contents`.

### Пользовательские функции {#custom-functions}

В устаревшем JS API пользовательские функции принимали отдельный JS аргумент для каждого аргумента Sass, с дополнительным callback `done` для асинхронных пользовательских функций. В современном API пользовательские функции принимают один JS аргумент, содержащий список всех аргументов Sass, при этом асинхронные пользовательские функции возвращают промис.

Современный API также использует гораздо более надёжный класс [`Value`](https://sass-lang.com/documentation/js-api/classes/Value/), который поддерживает все типы значений Sass, проверки типов и удобный доступ к картам и спискам.

### Бандлеры {#bundlers}

Если вы используете бандлер или другую утилиту, которая вызывает Sass API, а не использует его напрямую, вам может потребоваться изменить конфигурацию, передаваемую этой утилите, чтобы указать ей использовать современный API.

Webpack по умолчанию уже использует современный API, но если вы получаете предупреждения, установите `api` в `"modern"` или `"modern-compiler"`. См. [документацию Webpack](https://webpack.js.org/loaders/sass-loader/#api) для получения дополнительной информации.

Vite 6 использует современный API по умолчанию. Предыдущие версии Vite по-прежнему используют устаревший API, однако начиная с Vite 5.4 вы можете переключиться, установив `api` в `"modern"` или `"modern-compiler"`. См. [документацию Vite](https://vite-docs.ru/config/shared-options.html#css-preprocessoroptions) для получения дополнительной информации.

Для других инструментов проверьте их документацию или трекер задач на предмет информации о поддержке современного Sass API.

## Отключение предупреждений {#silencing-warnings}

Хотя устаревший JS API был помечен как устаревший в Dart Sass 1.45.0 одновременно с выпуском современного API, мы начали выдавать предупреждения при его использовании начиная с Dart Sass 1.79.0. Если вы пока не можете перейти на современный API, но хотите отключить предупреждения, вы можете передать `legacy-js-api` в опцию `silenceDeprecations`:

```js
const sass = require('sass');

const result = sass.renderSync({
  silenceDeprecations: ['legacy-js-api'],
  ...
});
```

Это отключит предупреждения на данный момент, но устаревший API будет полностью удалён в Dart Sass 2.0.0, поэтому вам всё равно следует планировать переход с него в ближайшее время.
